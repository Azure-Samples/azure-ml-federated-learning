
$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
name: ccfraud_eval
version: 0.1.0
display_name: CC Fraud Aggregate Model Evaluation
type: command
description: Component to evaluate the final aggregated CC Fraud model.
is_deterministic: false

inputs:
  test_data_dir:
    type: uri_folder
    description: the input testing data (preprocessed)
  model_name:
    type: string
    description: name of the model used
    enum: [SimpleLSTM, SimpleVAE, SimpleLinear]
    optional: false
  metrics_prefix:
    type: string
    description: Metrics prefix
    default: Default-prefix
    optional: true
  checkpoint:
    type: uri_folder
    description: a given pre-existing checkpoint
  batch_size:
    type: integer
    description: batch size
    default: 100
    optional: true
  fraud_weight_path:
    type: uri_folder
    description: the path to fraudweight


outputs:
  predictions:
    type: uri_folder
    description: predictions of model

code: ..

command: >-
  python evaluation/run_eval.py
  --test_data_dir ${{inputs.test_data_dir}}
  --model_name ${{inputs.model_name}}
  --checkpoint ${{inputs.checkpoint}}
  --predictions_path ${{outputs.predictions}}
  --fraud_weight_path ${{inputs.fraud_weight_path}}
  $[[--metrics_prefix ${{inputs.metrics_prefix}}]]
  $[[--batch_size ${{inputs.batch_size}}]]
environment: 
  conda_file: ./conda.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu20.04
