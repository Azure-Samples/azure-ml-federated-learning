
$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
name: he_encrypt
version: 0.3.0
display_name: HE Encrypt Model Weight
type: command
description: Component for using HE on a pytorch model
is_deterministic: true

inputs:
  model:
    type: uri_folder
    description: model state dict
    optional: false

outputs:
  encrypted_model:
    type: uri_folder
    description: the encrypted model
  encryption_key:
    type: uri_folder
    description: the encryption key

code: .

command: >-
  python encrypt.py 
  --model ${{inputs.model}} 
  --extension pt 
  --output ${{outputs.encrypted_model}} 
  --key_output ${{outputs.encryption_key}} 

environment:
  conda_file: ./conda.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu20.04
