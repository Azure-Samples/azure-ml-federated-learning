
$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
name: he_encrypt
version: 0.3.0
display_name: HE Encrypt Model Weight
type: command
description: Component for using HE on a pytorch model
is_deterministic: true

inputs:
  model:
    type: uri_folder
    description: model state dict
  he_context:
    type: uri_file
    description: the HF context from tenseal, provided as bin file

outputs:
  encrypted_model:
    type: uri_folder
    description: the encrypted model

code: .

command: >-
  python run.py 
  --input ${{inputs.model}} 
  --context ${{inputs.he_context}} 
  --output ${{outputs.encrypted_model}} 

environment:
  conda_file: ./conda.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu20.04
