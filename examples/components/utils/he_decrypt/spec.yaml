
$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
name: he_decrypt
version: 0.3.0
display_name: HE Decrypt Model Weight
type: command
description: Component for using HE on a pytorch model
is_deterministic: true

inputs:
  encrypted_model:
    type: uri_folder
    description: the encrypted model
    optional: true
  # he_context:
  #   type: uri_file
  #   description: the HF context from tenseal, provided as bin file

outputs:
  model:
    type: uri_folder
    description: model state dict

code: .
  # --context ${{inputs.he_context}} 

command: >-
  python run.py 
  $[[--input ${{inputs.encrypted_model}}]]
  --output ${{outputs.model}} 

environment:
  conda_file: ./conda.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu20.04
